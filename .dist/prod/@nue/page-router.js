async function I(j){dispatchEvent(new Event("before:route"));const x=W(await V(j));document.title=E("title",x)?.textContent,K(F("style"),F("style",x)).forEach((D)=>E("head").appendChild(D)),E("body").classList=E("body2",x).classList;const B=K(F("link"),F("link",x));X(B,()=>{Q(x),N(j),scrollTo(0,0),dispatchEvent(new Event("route"))})}var Q=function(j){for(let x of["header","main","footer"]){const z=E("body >"+x),B=E("body2 >"+x,j);if(z&&B){if(z.outerHTML!=B.outerHTML)z.replaceWith(B)}else if(z)z.remove();else if(B){const D=x=="footer"?"append":"prepend";document.body[D](B)}}};function R(j,x){j.addEventListener("click",(z)=>{const B=z.target.closest("[href]"),D=B?.getAttribute("href"),O=B?.getAttribute("target");if(z.defaultPrevented||z.metaKey||z.ctrlKey||z.shiftKey||z.altKey||!D||D[0]=="#"||D.includes("//")||D.startsWith("mailto:")||O=="_blank")return;if(D!=location.pathname)x(D);z.preventDefault()})}function N(j,x="active"){F(`[${x}]`).forEach((z)=>z.removeAttribute(x)),F(`[href="${j}"]`).forEach((z)=>z.toggleAttribute(x,!0))}var E=function(j,x=document){return x.querySelector(j)},F=function(j,x=document){return[...x.querySelectorAll(j)]},J=function(j,x){return x.find((z)=>z.getAttribute("href")==j.getAttribute("href"))},K=function(j,x){return j.forEach((z,B)=>z.disabled=!J(z,x)),x.filter((z)=>!J(z,j))};async function V(j){if(!G[j]){const x=await fetch(j);G[j]=await x.text()}return G[j]}var W=function(j){j=j.replace(/<(\/?)body/g,"<$1body2");const x=document.createElement("template");return x.innerHTML=j.trim(),x.content},X=function(j,x){let z=0;!j[0]?x():j.forEach((B,D)=>{Y(B.href,()=>{if(++z==j.length)x()})})},Y=function(j,x){const z=document.createElement("link");z.rel="stylesheet",z.href=j,E("head").appendChild(z),z.onload=x},U=typeof window=="object";if(U){if(!document.startViewTransition)document.startViewTransition=(j)=>j();history.pushState({path:location.pathname},0),R(document,async(j)=>{document.startViewTransition(async function(){await I(j),history.pushState({path:j},0,j)})}),N(location.pathname),addEventListener("popstate",(j)=>{const{path:x}=j.state||{};if(x)I(x)})}var G={};export{N as setActive,R as onclick,I as loadPage};
